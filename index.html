<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Prática com Tailwind e JavaScript</title>
    <!-- Carrega Tailwind CSS para estilização moderna e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define a fonte Inter como padrão */
        body { font-family: 'Inter', sans-serif; }
        /* Esconde a checkbox original para que possamos estilizar o seu label */
        input[type="checkbox"] {
            display: none;
        }
        /* Estilo da tarefa (li) */
        .task-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            margin-bottom: 8px;
            background-color: #f9fafb;
            border-left: 5px solid #3b82f6; /* Borda azul inicial */
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        /* Estilo quando a tarefa está concluída */
        .task-item.completed {
            border-left-color: #10b981; /* Borda verde */
            background-color: #f0fff4; /* Fundo mais claro para concluído */
            text-decoration: line-through;
            color: #9ca3af;
        }
        /* Estilo para a área de conteúdo da tarefa */
        .task-content {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }
        /* O ícone de check */
        .task-check {
            width: 24px;
            height: 24px;
            border: 2px solid #9ca3af;
            border-radius: 4px;
            margin-right: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: border-color 0.3s;
        }
        /* Estilo do checkmark (o V) */
        .task-check-icon {
            opacity: 0;
            transition: opacity 0.3s;
            color: white;
            font-weight: bold;
        }
        /* Estilo quando a tarefa está concluída: o ícone fica verde */
        .task-item.completed .task-check {
            background-color: #10b981;
            border-color: #10b981;
        }
        /* Estilo quando a tarefa está concluída: o V aparece */
        .task-item.completed .task-check-icon {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 md:p-8">

    <div id="app" class="w-full max-w-xl mx-auto">
        <h1 class="text-3xl font-extrabold text-gray-900 mb-6 text-center">
            Lista de Afazeres (To-Do List)
        </h1>

        <!-- Área de Input de Nova Tarefa -->
        <div class="flex space-x-3 mb-8">
            <input 
                type="text" 
                id="taskInput" 
                placeholder="Ex: Comprar pão, Estudar JS, Ligar para a mãe..."
                class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm transition duration-150"
                aria-label="Nova Tarefa"
            >
            <button 
                id="addTaskBtn"
                class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 shadow-md focus:outline-none focus:ring-4 focus:ring-blue-300 whitespace-nowrap"
            >
                Adicionar
            </button>
        </div>
        
        <!-- Contagem de Tarefas -->
        <div class="mb-4 text-sm font-medium text-gray-600 flex justify-between">
            <span id="taskCount">0 tarefas pendentes</span>
            <button id="clearCompletedBtn" class="text-red-500 hover:text-red-700 transition duration-150 text-xs font-semibold">
                Limpar Concluídas
            </button>
        </div>

        <!-- Lista de Tarefas -->
        <ul id="taskList" class="space-y-3">
            <!-- As tarefas serão inseridas aqui -->
        </ul>
        
        <!-- Mensagem de lista vazia -->
        <p id="emptyMessage" class="text-center text-gray-500 mt-10 italic hidden">
            Você não tem tarefas! Adicione a primeira para começar.
        </p>

    </div>

    <script>
        // Função para simular o crypto.randomUUID() caso o navegador não o suporte
        const generateUUID = () => {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        };

        // Estado global das tarefas
        let tasks = [];

        // Referências aos elementos do DOM
        const taskInput = document.getElementById('taskInput');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const taskList = document.getElementById('taskList');
        const taskCountElement = document.getElementById('taskCount');
        const emptyMessage = document.getElementById('emptyMessage');
        const clearCompletedBtn = document.getElementById('clearCompletedBtn');

        // --- FUNÇÕES DE RENDERIZAÇÃO E ATUALIZAÇÃO DO ESTADO ---

        // 1. Renderiza a tarefa na interface
        function renderTask(task) {
            // Cria o item da lista (<li>)
            const listItem = document.createElement('li');
            listItem.id = `task-${task.id}`;
            // Usa as classes de estilo definidas no <style>
            listItem.className = task.completed 
                ? 'task-item completed' 
                : 'task-item';
            
            listItem.innerHTML = `
                <div class="task-content">
                    <span class="task-check" aria-hidden="true">
                        <!-- Icone de check (V) -->
                        <span class="task-check-icon">✓</span>
                    </span>
                    <span class="task-text text-gray-900">${task.text}</span>
                </div>
                <button 
                    data-id="${task.id}" 
                    class="delete-btn text-red-500 hover:text-red-700 text-lg font-bold ml-4 p-1 rounded-full hover:bg-red-50 transition duration-150"
                    aria-label="Excluir tarefa"
                >
                    &times;
                </button>
            `;

            // Evento para marcar/desmarcar a tarefa
            listItem.querySelector('.task-content').addEventListener('click', (e) => {
                toggleTaskCompletion(task.id);
            });

            // Evento para excluir a tarefa
            listItem.querySelector('.delete-btn').addEventListener('click', (e) => {
                e.stopPropagation(); // Previne que o clique dispare o evento de 'toggle completion'
                deleteTask(task.id);
            });

            return listItem;
        }

        // 2. Atualiza a lista completa no DOM e a contagem
        function refreshTaskList() {
            taskList.innerHTML = ''; // Limpa a lista existente
            tasks.forEach(task => {
                taskList.appendChild(renderTask(task));
            });
            updateTaskCount();
            saveTasks(); // Salva o estado após cada alteração
            updateEmptyMessage();
        }

        // 3. Atualiza a contagem de tarefas pendentes
        function updateTaskCount() {
            const pendingCount = tasks.filter(task => !task.completed).length;
            taskCountElement.textContent = `${pendingCount} tarefa${pendingCount !== 1 ? 's' : ''} pendente${pendingCount !== 1 ? 's' : ''}`;
        }
        
        // 4. Mostra/esconde a mensagem de lista vazia
        function updateEmptyMessage() {
            if (tasks.length === 0) {
                emptyMessage.classList.remove('hidden');
            } else {
                emptyMessage.classList.add('hidden');
            }
        }

        // --- FUNÇÕES DE MANIPULAÇÃO DO ESTADO (CRUD) ---

        // 5. Adiciona uma nova tarefa
        function addTask() {
            const text = taskInput.value.trim();
            if (text === "") {
                // Em vez de alert(), podemos dar um feedback visual (opcional)
                taskInput.classList.add('border-red-500', 'ring-red-500');
                setTimeout(() => taskInput.classList.remove('border-red-500', 'ring-red-500'), 1000);
                return;
            }

            const newTask = {
                id: generateUUID(),
                text: text,
                completed: false
            };

            tasks.push(newTask);
            taskInput.value = ''; // Limpa o input
            taskInput.focus();
            refreshTaskList();
        }

        // 6. Alterna o estado de conclusão de uma tarefa
        function toggleTaskCompletion(id) {
            const taskIndex = tasks.findIndex(task => task.id === id);
            if (taskIndex > -1) {
                tasks[taskIndex].completed = !tasks[taskIndex].completed;
                refreshTaskList();
            }
        }

        // 7. Exclui uma tarefa
        function deleteTask(id) {
            tasks = tasks.filter(task => task.id !== id);
            refreshTaskList();
        }
        
        // 8. Limpa todas as tarefas concluídas (CORRIGIDO: Removida a confirmação)
        function clearCompletedTasks() {
            const initialTaskCount = tasks.length;
            // Filtra as tarefas, mantendo apenas as que NÃO estão completadas
            tasks = tasks.filter(task => !task.completed);
            
            // Só atualiza se houve remoção de tarefas (para evitar chamadas desnecessárias)
            if (tasks.length < initialTaskCount) {
                refreshTaskList();
            }
        }

        // --- PERSISTÊNCIA DE DADOS (LocalStorage) ---

        // 9. Salva as tarefas no LocalStorage
        function saveTasks() {
            // O LocalStorage é simples e perfeito para esta aplicação de um único usuário
            localStorage.setItem('taskListTasks', JSON.stringify(tasks));
        }

        // 10. Carrega as tarefas do LocalStorage
        function loadTasks() {
            const storedTasks = localStorage.getItem('taskListTasks');
            if (storedTasks) {
                tasks = JSON.parse(storedTasks);
            }
            refreshTaskList();
        }

        // --- INICIALIZAÇÃO ---

        // Configura os ouvintes de eventos
        addTaskBtn.addEventListener('click', addTask);
        taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTask();
            }
        });
        clearCompletedBtn.addEventListener('click', clearCompletedTasks);


        // Carrega as tarefas salvas quando a página carrega
        window.onload = loadTasks;

    </script>
</body>
</html>
